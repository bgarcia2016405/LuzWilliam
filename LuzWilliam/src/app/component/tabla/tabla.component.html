<a  class="btn btn-outline-secondary" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample" (click)="getIdentidad()">
  <i class="bi bi-lightning" (click)="getIdentidad()"></i>
</a>
<h1 style="text-align: right;">Listado Completo</h1>

<div><br><br>
  <select class="form-select sele" aria-label="Default select example"id="year" name="year" #year="ngModel" [(ngModel)]="Yearr.year" (change)="onChage()">
    <option selected>Año</option>
    <option value="2021">2021</option>
    <option value="2022">2022</option>
    <option value="2023">2022</option>
  </select>

<div *ngIf="state == 'table'"><br><br><br>
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Local</th>
        <th scope="col">Nombre</th>
        <th scope="col">Año</th>
        <th scope="col">Focos</th>
        <th scope="col" *ngIf="UserService.getIdentidad().type == 'Administrador'">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let local of lugar">
        <th scope="row">{{local.local}}</th>
        <td>{{local.nombre}} {{local.apellido}}</td>
        <td>{{local.year}}</td>
        <td><div class="btn-group">
          <button type="button" class="btn btn-outline-danger dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            Detalles
          </button>
          <ul class="dropdown-menu" style="border: solid 0.5px black;">
            <li><a class="dropdown-item">Num Focos: {{local.focos}}</a></li>
            <li><a class="dropdown-item">Precio U: {{local.precioUnidad}}</a></li>
            <li><a class="dropdown-item" >Total: {{local.precioTotal}}</a></li>
            <li><a class="dropdown-item" >Debe: {{local.debe}}</a></li>
            <li><hr class="dropdown-divider"></li>
            <li *ngIf="local.debe != 0"><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="iniciar(local._id)">Agregar Cuota</a></li>
            <li><a class="dropdown-item" (click)="cuota(local._id)">Pagos</a></li>
          </ul>
        </div></td>
      </tr>
    </tbody>
  </table>
</div>

<div *ngIf="state == 'textArea'" class="mb-3"><br><br><br>


  <div *ngFor="let cuotas of cuotaLocal.cuotas; let i = index">
    <p class="textos">    Cantidad:   {{cuotas.cantidad}}</p>
    <p class="textos">    Fecha:   {{cuotas.fecha}}</p>
    <p class="margen">----------------------------------</p>
  </div>

  <button type="button" class="btn btn-primary btn-sm" (click)="regresar()">Regresar</button>
</div>


</div>



<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Cuota {{pagoLocal.nombre}} {{pagoLocal.apellido}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="center">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" (click)="deshabilitar()" checked >
            <label class="form-check-label" for="flexRadioDefault1">
              Deshabilitado
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" (click)="deshabilitar()"  >
            <label class="form-check-label" for="flexRadioDefault2">
              Habilitado
            </label>
          </div>
        </div> <br><br><br><br>
        <div class="form-floating">
          <input type="number" class="form-control" id="floatingPassword" placeholder="Password" id="cantidad" name="cantidad" #cantidad="ngModel" [(ngModel)]="pagoca.cantidad"  [disabled]='habilitar'>
          <label for="floatingPassword">Cantidad</label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" (click)="pago()" [disabled]="habilitar">Guardar</button>
      </div>
    </div>
  </div>
</div>


<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasExampleLabel" *ngIf="UserService.getIdentidad() != null">{{identidad.nickName}}</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <div>
      <h3>Agregar Local</h3><br>
      <div class="form-floating mb-3">
        <input type="text" class="form-control" id="floatingInput" placeholder="byron" name="nombre" #nombre="ngModel" [(ngModel)]="nuevoLugar.nombre">
        <label for="floatingInput">Nombre</label>
      </div>
      <div class="form-floating mb-3">
        <input type="text" class="form-control" id="floatingInput" placeholder="garcia" name="apellido" #apellido="ngModel" [(ngModel)]="nuevoLugar.apellido">
        <label for="floatingInput">Apellido</label>
      </div>
      <div class="form-floating mb-3">
        <input type="number" class="form-control" id="floatingInput" placeholder="1" name="local" #local="ngModel" [(ngModel)]="nuevoLugar.local">
        <label for="floatingInput">Numero de local</label>
      </div>
      <div class="form-floating mb-3">
        <input type="number" class="form-control" id="floatingInput" placeholder="1" name="focos" #focos="ngModel" [(ngModel)]="nuevoLugar.focos">
        <label for="floatingInput">Cantidad de focos</label>
      </div>
      <div class="form-floating mb-3">
        <input type="number" class="form-control" id="floatingInput" placeholder="1" name="precioUnidad" #precioUnidad="ngModel" [(ngModel)]="nuevoLugar.precioUnidad">
        <label for="floatingInput">Precio por unidad</label>
      </div>
      <button type="button" class="btn btn-primary" data-bs-dismiss="offcanvas" (click)="crearLocal()">Guardar</button>
    </div>
  </div>
</div>
